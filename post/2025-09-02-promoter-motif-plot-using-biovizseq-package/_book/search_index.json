[["index.html", "Promoter motif plot using BioVizSeq package 1 Installing BioVizSeq package 1.1 struggle with package installation", " Promoter motif plot using BioVizSeq package Kazu Nozue 2025-09-02 1 Installing BioVizSeq package 1.1 struggle with package installation install.packages(&quot;BioVizSeq&quot;) library(BioVizSeq) library(shinydashboard) install.packages(&quot;shinycssloaders&quot;) # /var/folders/_w/7dj610fh8xn6h8001s7_5h3r0000gn/T//Rtmph1L7Mw/downloaded_packages install.packages(&quot;shinycssloaders&quot;,lib=&quot;/var/folders/_w/7dj610fh8xn6h8001s7_5h3r0000gn/T//Rtmph1L7Mw/downloaded_packages/shinycssloaders&quot;) install.packages(&quot;/Users/nozue/Downloads/shinydashboard_0.7.3.tar.gz&quot;, repos = NULL, type = &quot;source&quot;) library(shinycssloaders) library(shinyWidgets) biovizseq() "],["first-get-plant-promoter-motif-search-at-plantcare-site.html", "2 First get plant promoter motif search at PlantCARE site", " 2 First get plant promoter motif search at PlantCARE site This site is using plant promoter motif database. But the promoter motif data is old. "],["ram1-solyc02g094340.1-ram2-solyc02g087500.3-solyc04g005840.1-solyc10g084900.html", "3 RAM1 (“Solyc02g094340.1”), RAM2 (“Solyc02g087500.3”, “Solyc04g005840.1”, “Solyc10g084900.1”)", " 3 RAM1 (“Solyc02g094340.1”), RAM2 (“Solyc02g087500.3”, “Solyc04g005840.1”, “Solyc10g084900.1”) library(BioVizSeq) # SL RAM1 prom data (PlantCARE_16059), PlantCARE_16059_SL_RAM1prom_plantCARE plantcare_file.Solyc02g094340 &lt;- read.table(&quot;/Volumes/data_work/Data6/Sinha_lab/PlasticityIII_AMF_TRAP/AMF_responsive_gene_promoters/PlantCARE_16059_SL_RAM1_prom_plantCARE/plantCARE_output_PlantCARE_16059.tab&quot;, header = FALSE, sep = &#39;\\t&#39;, quote=&quot;&quot;) # SL RAM2a (tentatively called) &quot;Solyc02g087500.3&quot; prom data () plantcare_file.Solyc02g087500 &lt;- read.table(&quot;/Volumes/data_work/Data6/Sinha_lab/PlasticityIII_AMF_TRAP/AMF_responsive_gene_promoters/PlantCARE_18029_RAM2a_prom_plantCARE/plantCARE_output_PlantCARE_18029.tab&quot;, header = FALSE, sep = &#39;\\t&#39;, quote=&quot;&quot;) # SL RAM2b prom data Solyc04g005840, PlantCARE_28616 plantcare_file.Solyc04g005840 &lt;- read.table(&quot;/Volumes/data_work/Data6/Sinha_lab/PlasticityIII_AMF_TRAP/AMF_responsive_gene_promoters/PlantCARE_28616_SLRAM2B_prom_plantCARE/plantCARE_output_PlantCARE_28616.tab&quot;, header = FALSE, sep = &#39;\\t&#39;, quote=&quot;&quot;) # SL RAM2c prom data Solyc10g084900 PlantCARE_31086 plantcare_file.Solyc10g08490 &lt;- read.table(&quot;/Volumes/data_work/Data6/Sinha_lab/PlasticityIII_AMF_TRAP/AMF_responsive_gene_promoters/PlantCARE_31086_SLRAM2C_prom_plantCARE/plantCARE_output_PlantCARE_31086.tab&quot;, header = FALSE, sep = &#39;\\t&#39;, quote=&quot;&quot;) # change format plantcare_file.Solyc02g094340 &lt;- plantcare_classify(plantcare_file.Solyc02g094340) %&gt;% mutate(ID=&quot;RAM1 Solyc02g094340&quot;) plantcare_file.Solyc02g087500 &lt;- plantcare_classify(plantcare_file.Solyc02g087500) %&gt;% mutate(ID=&quot;RAM2a Solyc02g087500&quot;) plantcare_file.Solyc04g005840 &lt;- plantcare_classify(plantcare_file.Solyc04g005840) %&gt;% mutate(ID=&quot;RAM2b Solyc04g005840&quot;) plantcare_file.Solyc10g08490 &lt;- plantcare_classify(plantcare_file.Solyc10g08490) %&gt;% mutate(ID=&quot;RAM2c Solyc10g08490&quot;) # combine plantcare_loc &lt;- plantcare_to_loc(bind_rows(plantcare_file.Solyc02g094340,plantcare_file.Solyc02g087500, plantcare_file.Solyc04g005840, plantcare_file.Solyc10g08490)) promoter_length &lt;- data.frame(ID = unique(plantcare_loc$ID), length=5000) # all elements motif_plot(plantcare_loc, promoter_length,show_motif_id=FALSE) + labs(x=&quot;Promoter Length&quot;, y=&quot;Gene&quot;) # &quot;abscisic acid&quot;, SA, JA, mixed stress, wound, ethylene motif_plot(plantcare_loc %&gt;% filter(element %in% c(&quot;salicylic acid&quot;,&quot;JA&quot;,&quot;abscisic acid&quot;,&quot;mixed stress&quot;,&quot;wound&quot;,&quot;ethylene&quot;)), promoter_length,show_motif_id=FALSE,) + labs(x=&quot;Promoter Length&quot;, y=&quot;Gene&quot;) # facet_grid does not work #motif_plot(plantcare_loc, promoter_length,show_motif_id=FALSE) + labs(x=&quot;Promoter Length&quot;, y=&quot;Gene&quot;) + facet_wrap(element~.) # SA and JA motif_plot(plantcare_loc %&gt;% filter(element %in% c(&quot;salicylic acid&quot;,&quot;JA&quot;)), promoter_length,show_motif_id=FALSE,) + labs(x=&quot;Promoter Length&quot;, y=&quot;Gene&quot;) "],["how-to-plot-promoter-motif-of-interest-in-fyi-gene-promoters-100-genes.html", "4 How to plot promoter motif of interest in FYI gene promoters (~ 100 genes)?", " 4 How to plot promoter motif of interest in FYI gene promoters (~ 100 genes)? PHOSPHATE STARVATION RESPONSE (PHR) transcription factors belong to the MYB transcription factor (TF) family and bind to PHR1 binding site (P1BS) motifs (GNATATNC) in the promoters of phosphate starvation-induced (PSI) genes. Rice OsPHS2 is necessary for AMF colonization (Das 2022). Here I am just looking P1BS motifs in core AMF pathway genes in tomato reported in Zeng 2023. 4.0.1 step A. Bulk extraction of 2 kb promoter region sequences of all tomato genes. 4.0.2 step B. Get gene of interest (this thime, AMF core genes) 4.0.3 step C. Extract the promoter sequences of FYI genes in step B. 4.0.4 step D. Find a promoter motif of interest in the promoter sequences (in fasta format) 4.0.5 step E. Plot the position of the motif in the promoters 4.0.6 step A. extract promoters of genes of interest by bulk extraction of promoter sequences using EnsemblPlant BioMart interface 4.0.6.1 Step 1: Access the BioMart interface Go to the Ensembl Plants website. Click on the BioMart link, which is usually located in the header or in the “Tools” section. 4.0.6.2 Step 2: Select the database and dataset On the BioMart page, under “CHOOSE DATABASE,” select Ensembl Plants Genes. Under “CHOOSE DATASET,” find and select your species of interest (e.g., Arabidopsis thaliana genes or Zea mays genes). 4.0.6.3 Step 3: Add your gene filters In the left-hand panel, click Filters. Expand the “GENE” section. Here you can input your gene list. For example, use the filter “Gene stable ID(s)” and paste a list of Ensembl gene IDs. You can use other filters, such as gene name or chromosome location, if you don’t have a list of Ensembl gene IDs. 4.0.6.4 Step 4: Define the sequence attributes In the left-hand panel, click Attributes. Expand the “SEQUENCES” section. Select the “Flank (Upstream)” attribute. This is the crucial step for defining the promoter region. In the “Flank (Upstream)” options, specify the following: Upstream flanking region: Enter the number of base pairs you want to retrieve upstream of the gene’s transcription start site (e.g., 1500 bp, a common length for promoter analysis). Downstream flanking region: Set this to 0 since you only want the upstream region. Strand: Select “Coding strand” or “Sense strand”. For promoter extraction, retrieving the sequence on the same strand as the gene is standard. 4.0.6.5 Step 5: Configure your output Under the “ATTRIBUTES” section, you can add other desired output information, such as “Gene stable ID” or “Associated Gene Name” to easily link the sequences back to your original genes. Click the “Results” button in the left-hand panel. On the results page, you can review a preview of your query. To download the sequences, click “Export all results to”. Select “File”, choose “FASTA” as the file format, and then click the “Go” button. This will download your promoter sequences in FASTA format. 4.0.7 Step B. Orthogroup table (supplementary table S7) for AMF core genes reported in Zeng 2023. library(tidyverse) Zeng_2023_S7 &lt;- readxl::read_excel(&quot;/Volumes/data_work/Data6/Sinha_lab/PlasticityIII_AMF_TRAP/ScienceDirect_files_20Feb2024_21-27-28.124/1-s2.0-S2590346222002619-mmc2.xlsx&quot;,sheet=&quot;Table S7&quot;,skip=1) %&gt;% drop_na() # needs to format this table to use inner_join() (see &quot;00_annotation.Rmd&quot;) # step1 for itag4.1 brake.into.singleID4a &lt;- function(DT=Zeng_2023_S7,target.column=&quot;Solanum_lycopersicum&quot;) { #target.column &lt;- enquo(target.column) print(target.column) x &lt;- DT %&gt;% dplyr::select(all_of(target.column)) %&gt;% as_vector() %&gt;% str_split(&quot;, &quot;) %&gt;% unlist() DT %&gt;% dplyr::select(-all_of(target.column)) %&gt;% right_join(tibble(Orthogroup=rep(DT %&gt;% dplyr::select(Orthogroup) %&gt;% as_vector(),length(x)), Solanum_lycopersicum = x)) } # test temp &lt;- brake.into.singleID4a(DT=Zeng_2023_S7 %&gt;% dplyr::slice(1:1)) # for(n in 1:dim(Zeng_2023_S7)[1]) { print(&quot;n is &quot;);print(n) temp &lt;- temp %&gt;% bind_rows(brake.into.singleID4a(Zeng_2023_S7 %&gt;% dplyr::slice(n:n))) } temp %&gt;% View() Zeng_2023_S7.v2 &lt;- temp %&gt;% separate(Solanum_lycopersicum,sep=&quot;\\\\.&quot;,into=&quot;gene&quot;,extra=&quot;drop&quot;,fill=&quot;left&quot;,remove=FALSE) Zeng_2023_S7.v2 %&gt;% View() # extract only tomato genes and format SL.AMFcore.Zeng2023.gene.df &lt;- Zeng_2023_S7.v2 %&gt;% distinct(Solanum_lycopersicum) %&gt;% dplyr::select(Solanum_lycopersicum) %&gt;% mutate(Solanum_lycopersicum=str_remove_all(Solanum_lycopersicum,&quot;Sly_&quot;)) %&gt;% separate(Solanum_lycopersicum,c(&quot;v1&quot;,&quot;v2&quot;,&quot;v3&quot;),remove=FALSE) %&gt;% filter(str_detect(Solanum_lycopersicum,&quot;Solyc&quot;)) %&gt;% select(v1) # write write_csv(SL.AMFcore.Zeng2023.gene.df,file.path(&quot;SL.AMFcore.Zeng2023.gene.csv&quot;)) # SL.AMFcore.Zeng2023.gene &lt;- SL.AMFcore.Zeng2023.gene.df %&gt;% as_vector() 4.0.8 Step C-1 modify output from Biomart in EnesmbplePlant by awk in UNIX system(&quot;awk &#39;/^&gt;/ {if (N&gt;0) printf(\\&quot;\\\\n\\&quot;); printf(\\&quot;%s\\\\t\\&quot;,$0); N++; next;} {printf(\\&quot;%s\\&quot;,$0);} END {printf(\\&quot;\\\\n\\&quot;);}&#39; mart_export.txt &gt; mart_export_mod.txt&quot;) # look system(&quot;head mart_export_mod.txt&quot;) 4.0.9 Step C-2 Extracting promoter sequences of FYI genes by R + UNIX. Learning from ChatGPT answer. out_file &lt;- &quot;SL.AMFcore.Zeng2023_prom2000.fasta&quot; # shQuote() is for Quote a string to be passed to an operating system shell. for (gene in SL.AMFcore.Zeng2023.gene) { cmd &lt;- paste( &quot;grep&quot;, shQuote(gene), &quot;mart_export_mod.txt | tr &#39;\\\\t&#39; &#39;\\\\n&#39; &gt;&gt;&quot;, out_file ) print(cmd) system(cmd) # run UNIX command } # works well 4.0.10 Step D. PIBS promoter motif analysis Custom motif (“GNATATNC” for P1BS) finding in given promoter sequences “RSAT - dna-pattern” used in Das (2022). 4.0.11 Step E. read P1BS promoter motif analysis resuls RSAT website and plot Use BioVizSeq package above. library(BioVizSeq) # remove &quot;;&quot; for column name SL.AMFcore.Zeng2023.P1BS &lt;- readr::read_delim(file.path(&quot;/Volumes&quot;,&quot;data_work&quot;,&quot;Data8&quot;,&quot;NGS_related&quot;,&quot;Sinha_lab&quot;,&quot;RNAseq_tomato_AMF&quot;,&quot;output&quot;,&quot;dna-pattern_2025-08-28.072501_h5Ildx.pat&quot;), comment=&quot;;&quot;,col_names=TRUE,delim=&quot;\\t&quot;) ## Rows: 154 Columns: 8 ## ── Column specification ───────────────────────────────────────────────────────────────────────────────────── ## Delimiter: &quot;\\t&quot; ## chr (5): PatID, Strand, Pattern, SeqID, matching_seq ## dbl (3): Start, End, Score ## ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. SL.AMFcore.Zeng2023.P1BS.loc &lt;- SL.AMFcore.Zeng2023.P1BS %&gt;% filter(!PatID==&quot;START_END&quot;) %&gt;% mutate(element=&quot;P1BS&quot;) %&gt;% dplyr::select(SeqID,element,Start,End) %&gt;% rename(ID=SeqID,start=Start,end=End) %&gt;% as.data.frame() # add promoter length #data.frame(ID = unique(plantcare_loc.SL$ID), length=5000) promoter_length &lt;- SL.AMFcore.Zeng2023.P1BS %&gt;% semi_join(SL.AMFcore.Zeng2023.P1BS.loc,by=join_by(SeqID==ID)) %&gt;% filter(PatID==&quot;START_END&quot;) %&gt;% mutate(length=Start) %&gt;% dplyr::select(SeqID,length) %&gt;% as.data.frame() # plot p.P1BS &lt;- motif_plot(SL.AMFcore.Zeng2023.P1BS.loc,promoter_length,motif_color=&quot;blue&quot;) + labs(x=&quot;Promoter Length&quot;, y=&quot;Gene&quot;) p.P1BS #p.P1BS + theme(line = element_line(&quot;blue&quot;)) # does not work #p.P1BS + theme(plot.background = element_rect(color=&quot;blue&quot;)) # does not work # how many genes ad P1BS? SL.AMFcore.Zeng2023.P1BS.loc %&gt;% count(ID) %&gt;% dim() # 38 genes ## [1] 38 2 length(SL.AMFcore.Zeng2023.gene) # 132 genes total ## [1] 132 # save #ggsave(p.P1BS,file=&quot;promoter_motisf_P1BS_SL.AMFcore.Zeng2023.png&quot;,width=11,height=8) "],["session-info.html", "5 Session Info", " 5 Session Info sessionInfo() ## R version 4.5.0 (2025-04-11) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Sonoma 14.4 ## ## Matrix products: default ## BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib; LAPACK version 3.12.1 ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## time zone: America/Los_Angeles ## tzcode source: internal ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] shiny_1.11.1 shinydashboard_0.7.3 promises_1.3.3 htmltools_0.5.8.1 BioVizSeq_1.0.3 ## [6] lubridate_1.9.4 forcats_1.0.0 stringr_1.5.1 dplyr_1.1.4 purrr_1.1.0 ## [11] readr_2.1.5 tidyr_1.3.1 tibble_3.3.0 ggplot2_3.5.2 tidyverse_2.0.0 ## [16] biomaRt_2.64.0 ## ## loaded via a namespace (and not attached): ## [1] DBI_1.2.3 httr2_1.2.1 readxl_1.4.5 rlang_1.1.6 ## [5] magrittr_2.0.3 ade4_1.7-23 compiler_4.5.0 RSQLite_2.4.2 ## [9] systemfonts_1.2.3 png_0.1-8 vctrs_0.6.5 pkgconfig_2.0.3 ## [13] crayon_1.5.3 fastmap_1.2.0 dbplyr_2.5.0 XVector_0.48.0 ## [17] labeling_0.4.3 utf8_1.2.6 rmarkdown_2.29 tzdb_0.5.0 ## [21] ps_1.9.1 UCSC.utils_1.4.0 ragg_1.4.0 bit_4.6.0 ## [25] xfun_0.52 cachem_1.1.0 seqinr_4.2-36 aplot_0.2.8 ## [29] GenomeInfoDb_1.44.1 jsonlite_2.0.0 progress_1.2.3 blob_1.2.4 ## [33] later_1.4.2 parallel_4.5.0 prettyunits_1.2.0 R6_2.6.1 ## [37] bslib_0.9.0 stringi_1.8.7 RColorBrewer_1.1-3 pkgload_1.4.0 ## [41] jquerylib_0.1.4 cellranger_1.1.0 bookdown_0.43 Rcpp_1.1.0 ## [45] knitr_1.50 IRanges_2.42.0 httpuv_1.6.16 timechange_0.3.0 ## [49] tidyselect_1.2.1 rstudioapi_0.17.1 yaml_2.3.10 miniUI_0.1.2 ## [53] blogdown_1.21 processx_3.8.6 curl_6.4.0 lattice_0.22-7 ## [57] Biobase_2.68.0 treeio_1.32.0 withr_3.0.2 KEGGREST_1.48.1 ## [61] evaluate_1.0.4 gridGraphics_0.5-1 BiocFileCache_2.16.1 xml2_1.3.8 ## [65] Biostrings_2.76.0 pillar_1.11.0 ggtree_3.16.3 filelock_1.0.3 ## [69] stats4_4.5.0 ggfun_0.2.0 generics_0.1.4 vroom_1.6.5 ## [73] servr_0.32 S4Vectors_0.46.0 hms_1.1.3 scales_1.4.0 ## [77] tidytree_0.4.6 xtable_1.8-4 glue_1.8.0 lazyeval_0.2.2 ## [81] tools_4.5.0 fs_1.6.6 grid_4.5.0 ape_5.8-1 ## [85] AnnotationDbi_1.70.0 nlme_3.1-168 GenomeInfoDbData_1.2.14 patchwork_1.3.1 ## [89] cli_3.6.5 rappdirs_0.3.3 textshaping_1.0.1 gtable_0.3.6 ## [93] ggh4x_0.3.1 yulab.utils_0.2.0 sass_0.4.10 digest_0.6.37 ## [97] BiocGenerics_0.54.0 ggplotify_0.1.2 farver_2.1.2 memoise_2.0.1 ## [101] lifecycle_1.0.4 httr_1.4.7 mime_0.13 bit64_4.6.0-1 ## [105] MASS_7.3-65 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
